<div class="container">
  <h1>利用者　情報編集</h1>
  <p>Find me in app/views/learner/users/edit.html.erb</p>
  <%= form_with model:@user, url: learner_user_path(@user) do |f| %>
  <div class="form-row align-items-center">
    <div class="col-md-7 mb-3">
      <div class="field">
        <%= attachment_image_tag current_learner_user, :image, id: "prev_image", fallback: "no_image.jpg", size:"100x100", style: "border-radius: 18px;",  onClick: "$('#change_image').click()" %>
        <%= f.attachment_field :image, id: "change_image" %>
        <i class="fas fa-sync-alt fa-2x fa-fw" onClick="$('#change_image').click()" ></i>
      </div>
    </div>
    <div class="col-md-7 mb-3">
      <div class="field">
        <%= f.label :"name", "お名前" %><br />
        <%= f.text_field :name, autofocus: true, autocomplete: "name" %>
      </div>
    </div>
    <div class="col-md-7 mb-3">
      <div class="field">
        <%= f.label :email, "メールアドレス" %><br />
        <%= f.email_field :email, autofocus: true, autocomplete: "email" %>
      </div>
    </div>
    <div class="col-md-7 mb-3">
      <div class="field">
        <%= f.label :language, "学習言語を登録" %>
        <%= f.collection_select :language, @languages, :language, :language, {prompt: "選択してください"}, class: "custom-select mr-sm-2" %><br>
      </div>
    </div>
    <div class="col-md-7 mb-3">
      <div class="field">
        <%= f.label :level, "学習レベルを登録" %>
        <%#= f.select :level, User.levels.keys.to_a, {}, class: "custom-select mr-sm-2" %><br>
        <%= f.select :level, User.levels.keys.map {|k| [k, k]},{}, class: "custom-select mr-sm-2" %>
      </div>
    </div>
    <div class="col-md-7 mb-3">
      <div class="field">
        <%= f.label :introduction, "自己紹介" %>
        <%= f.text_area :introduction, class: "form-control", rows: "3" %>
      </div>
    </div>
    <div class="col-md-7 mb-3">
      <%= f.submit "登録", class:'btn btn-success' %>
    </div>
  </div>
  <% end %>
</div>

<script>
$(function(){
    $('#change_image').on('change', function (e) {
    var new_image = new FileReader();
    new_image.onload = function (e) {
        $("#prev_image").attr('src', e.target.result);
    }
    new_image.readAsDataURL(e.target.files[0]);
});
});
</script>